/*! For license information please see docs-databaseSchema-stories-mdx.a3bad75c.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_wordpress_wp_feature_notifications_stories=self.webpackChunk_wordpress_wp_feature_notifications_stories||[]).push([[267],{"../node_modules/@mdx-js/react/lib/index.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{NF:function(){return withMDXComponents},Zo:function(){return MDXProvider},ah:function(){return useMDXComponents},pC:function(){return MDXContext}});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/react/index.js");const MDXContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({});function withMDXComponents(Component){return function boundMDXComponent(props){const allComponents=useMDXComponents(props.components);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(Component,{...props,allComponents:allComponents})}}function useMDXComponents(components){const contextComponents=react__WEBPACK_IMPORTED_MODULE_0__.useContext(MDXContext);return react__WEBPACK_IMPORTED_MODULE_0__.useMemo((()=>"function"==typeof components?components(contextComponents):{...contextComponents,...components}),[contextComponents,components])}const emptyObject={};function MDXProvider({components:components,children:children,disableParentContext:disableParentContext}){let allComponents;return allComponents=disableParentContext?"function"==typeof components?components({}):components||emptyObject:useMDXComponents(components),react__WEBPACK_IMPORTED_MODULE_0__.createElement(MDXContext.Provider,{value:allComponents},children)}},"../node_modules/@storybook/addon-docs/dist/index.mjs":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{h_:function(){return _storybook_blocks__WEBPACK_IMPORTED_MODULE_2__.h_}});__webpack_require__("../node_modules/@storybook/addon-docs/dist/chunk-PCJTTTQV.mjs"),__webpack_require__("../node_modules/@storybook/addon-docs/dist/chunk-R4NKYYJA.mjs");var _storybook_blocks__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@storybook/blocks/dist/index.mjs")},"./stories/docs/databaseSchema.stories.mdx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__page:function(){return __page},default:function(){return databaseSchema_stories}});__webpack_require__("../node_modules/react/index.js");var lib=__webpack_require__("../node_modules/@mdx-js/react/lib/index.js"),dist=__webpack_require__("../node_modules/@storybook/addon-docs/dist/index.mjs"),blocks_dist=__webpack_require__("../node_modules/@storybook/blocks/dist/index.mjs"),jsx_runtime=__webpack_require__("../node_modules/react/jsx-runtime.js");const __page=()=>{throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};const componentMeta={title:"Documentation/Database Schema",tags:["stories-mdx"],includeStories:["__page"]};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs={...componentMeta.parameters.docs||{},page:function MDXContent(props={}){const{wrapper:MDXLayout}=Object.assign({},(0,lib.ah)(),props.components);return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,{...props,children:(0,jsx_runtime.jsx)(_createMdxContent,{})}):_createMdxContent();function _createMdxContent(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(dist.h_,{title:"Documentation/Database Schema"}),"\n",(0,jsx_runtime.jsx)(blocks_dist.UG,{children:"# Database Schema\n\n## Key features\n\n- Ability to target individual users and maintain a history of their notifications.\n- Organization of notifications by channel.\n- Subscriptions and snooze functionality.\n- Table structure optimized for search by user or channel. Minimizing repetitive string data.\n\n## Message schema\n\nMessage data is related to many users through the `wp_notifications_queue` table.\n\nMessage are translated at the time of emission to the preferences of the users subscribed to the channel. A single notice emission may have multiple translated message row entries.\n\n### wp_notifications_messages table\n\n- `id: BIGINT(30)` - The ID of the notification.\n\n- `channel_name: VARCHAR(32)` - The scoped channel name the notification was emitted from.\n\n- `created_at: DATETIME` - The timestamp of when the message was broadcast.\n\n- `title: TINYTEXT` - The translated title of the notification.\n\n- `message: TINYTEXT` - The translated message content of the notification.\n\n- `meta: JSON` - Data that doesnâ€™t have to be queried and may change while development of the notification system.\n\n  - `accept_label:  string|null` - The translated accept action label.\n\n  - `accept_link:   string|null` - The URL of the accept action.\n\n  - `channel_title: string|null` - The translated, human-readable title of the channel the message was emitted from.\n\n  - `dismiss_label: string|null` - The translated dismiss action label.\n\n  - `icon:          string|null` - The icon of the notification message.\n\n  - `is_dismissible boolean|null` - Whether the notification is dismissible.\n\n    Most persisted notifications should be dismissible, otherwise they will not be able to be removed from the notification system by the user. But this is left as a way to maintain a compatible API with the existing notices.\n\n  - `severity:      string|null` - The severity of the message, examples: info, warning, alert.\n\n    This should be a predefined list of values.\n\n## Message Queue\n\nJoin table to map messages to specific users. Could periodically be cleared depending on message `expires_at` and/or how long ago it was dismissed.\n\nThe full history of messages for every user is retained and could be easily looked up.\n\nIf a message has been orphan it can safely be deleted.\n\n### wp_notifications_queue table\n\n- `message_id: BIGINT(20)` - The ID of the translated message related to the notice.\n\n- `user_id: BIGINT(20)` - The ID of the user the notice belongs to.\n\n- `channel_name: VARCHAR(64)` - The namespaced channel name the notice was emitted from.\n\n- `context: VARCHAR(64)` - The display context of the notice.\n\n- `created_at: DATETIME|NULL` - The datetime of when the notice was create.\n\n- `dismissed_at: DATETIME|NULL` - The datetime of when the notice was dismissed.\n\n- `displayed_at: DATETIME|NULL` - The datetime of when the notice was first displayed.\n\n- `expires_at:  DATETIME|NULL` - The optional datetime of when the message expires.\n\n  Allowing notice emitters to specify when a notice expires would help signal when it is appropriate to automatically dispose of a notice. It should be best practice to provide `expires_at` for any notice that isn't high priority.\n\n## Subscriptions\n\nTable used to determine for whom to enqueue messages when emitting a notification from a channel.\n\nLogic to authorize a users to subscribe to a channel would be based on a comparison of the `role` property of the channel and user.\n\nNotifications can become overwhelming if the user isn't provided with options to snooze and/or unsubscribe from channels.\n\n### wp_notifications_subscriptions\n\n- `user_id: BIGINT(20)` - The ID of the user the subscription belongs to.\n\n- `channel_name: VARCHAR(65)` - The scoped name of the channel subscribed to.\n\n- `created_at: DATETIME|NULL` - The datetime of when the subscription was create.\n\n- `snoozed_until: DATETIME|NULL` - The optional timestamp of when to resume the channel.\n\n## Metadata\n\nThe `meta` field of the message and channel tables could be stored in another table, similar to other WordPress schemas. Though keeping it in the same table reduces the number of queries.\n\n## Channels\n\nThe concept of channels is similar to block types in the editor. They are registered in code by plugins and the scoped name is used for channel discovery through the `Channel_Registry`. See PR [#251](https://github.com/WordPress/wp-feature-notifications/pull/251) for details about the channel registry.\n"})]})}}};var databaseSchema_stories=componentMeta},"../node_modules/react/cjs/react-jsx-runtime.production.min.js":function(__unused_webpack_module,exports,__webpack_require__){var f=__webpack_require__("../node_modules/react/index.js"),k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function q(c,a,g){var b,d={},e=null,h=null;for(b in void 0!==g&&(e=""+g),void 0!==a.key&&(e=""+a.key),void 0!==a.ref&&(h=a.ref),a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l,exports.jsx=q,exports.jsxs=q},"../node_modules/react/jsx-runtime.js":function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__("../node_modules/react/cjs/react-jsx-runtime.production.min.js")}}]);